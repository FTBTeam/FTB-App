stages:
  - prepare
  - build

prepare_frontend:
  stage: prepare
  image: node:18
  cache:
    key: ftb-app-frontend
    policy: pull-push
    paths:
      - node_modules/
  tags:
    - linux-aarch64
  script:
    - npm install --global yarn || true
    - yarn install
  interruptible: false

build_jar:
  stage: prepare
  trigger:
    include: subprocess/.gitlab-ci-jar.yml
    strategy: depend

build_overwolf:
  stage: build
  needs: ["build_jar", "prepare_frontend"]
  trigger:
    include: .gitlab-ci-front.yml
    strategy: depend

build_electron:
  stage: build
  needs: ["build_jar", "prepare_frontend"]
  trigger:
    include: subprocess/.gitlab-ci.yml
    strategy: depend
